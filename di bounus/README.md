# MAC Forgery Demonstration Using Length Extension Attack

This project demonstrates the difference between a **naive MAC implementation** using `MD5(secret || message)` and a **secure HMAC implementation**, and shows how an attacker can exploit the naive scheme using a length extension attack.

## Project Structure

.
â”œâ”€â”€ server.py # Server with naive MD5-based MAC (vulnerable)
â”œâ”€â”€ secure_server.py # Server using HMAC-MD5 (secure)
â”œâ”€â”€ client.py # Attacker script using hashpumpy to forge MACs
â”œâ”€â”€ attack_attempts.txt # Auto-generated file logging attack results
â””â”€â”€ README.md # You're reading it!


---

## âš™ï¸ Requirements

- Python 3.x
- `hashpumpy` module  
  Install with:

  ```bash
  pip install hashpumpy

ğŸ§ª How to Run the Demo
1. Run the Naive Server

Start the naive server:

python server.py

It will display a legitimate MAC and automatically attempt to verify forged messages from attack_attempts.txt.
2. Run the Attacker Script

In another terminal, run:

python client.py

It will:

    Prompt you to paste the MAC intercepted from the server output.

    Try key lengths from 1 to 20 using hashpumpy.

    Save all attempts in attack_attempts.txt.

3. Run the Secure Server (HMAC)

Try verifying the same forged messages with the secure server:

python secureserver.py

Youâ€™ll see that all forgery attempts fail because HMAC is not vulnerable to length extension.
ğŸ“‚ File: attack_attempts.txt

This file is automatically generated by the attacker script and logs each attempt:

Trying key length: 12
Forged message (bytes): b'amount=100&to=alice\x80...\x00&admin=true'
Forged MAC: f41dcfe4b6ea...
----------------------------------------

ğŸ” Why HMAC Is Safe

Unlike naive MACs (hash(secret || message)), HMAC is specifically designed to avoid structural vulnerabilities of hash functions like MD5. It wraps the message and key in a secure construction that prevents length extension attacks.
ğŸ§  Learning Objectives

    Understand the structure of insecure MAC constructions.

    Learn about length extension attacks.

    Appreciate the security of HMAC over naive hashes.
